SELECT 
    *
FROM
    sql_project.bankrupcy_dataset;
    
#1. NUMBER OF COMPANIES BANKRUPT
SELECT 
    COUNT(Company_id)
FROM
    bankrupcy_dataset
WHERE
    Bankrupt = 1;
    
#2. NUMBER OF COUNTRIES NOT BANKRUPT
SELECT 
    COUNT(Company_id)
FROM
    bankrupcy_dataset
WHERE
    Bankrupt = 0;
    
#3. NUMBER OF COMPANIES WITH A POSITIVE ROA
SELECT 
    COUNT(company_id)
FROM
    bankrupcy_dataset
WHERE
    ROA_before_interest_and_depreciation_before_interest > 0;
    
#4. CALCULATE THE AVERAGE ROA FOR ALL COMPANIES
SELECT 
    AVG(ROA_before_interest_and_depreciation_before_interest) AS avg_roa
FROM
    bankrupcy_dataset;

#5.COMPANY WITH HIGHEST AND LOWEST NET VALUE PERSHARE
SELECT 
    company_id, net_value_per_share
FROM
    bankrupcy_dataset
ORDER BY Company_id DESC
LIMIT 1;

SELECT 
    company_id, net_value_per_share
FROM
    bankrupcy_dataset
ORDER BY Company_id
LIMIT 1;

#6. TOTAL REVENUE GENERATED BY ALL THE COMPANIES
SELECT 
    SUM(Revenue_Per_Person) AS total_revenue
FROM
    bankrupcy_dataset;
    
#7. CALCULATE THE AVERAGE OPERATING PROFIT RATE AND INTEREST COVERAGE RATIO AMONG THE BANKRUPT COMPANIES
SELECT 
    AVG(operating_profit_rate), AVG(interest_coverage_ratio)
FROM
    bankrupcy_dataset
WHERE
    Bankrupt = 1;
    
#8. AVERAGE TOTAL ASSET GROWTH RATE OF NON-BANKRUPT COMPANIES
SELECT 
    AVG(Total_Asset_Growth_Rate)
FROM
    bankrupcy_dataset
WHERE
    Bankrupt = 0;
    
#9. NUMBER OF COMPANIES WITH TOTAL ASSET TO GNP PRICE GREATER THAN 1
SELECT 
    COUNT(*) as number_of_companies
FROM
    bankrupcy_dataset
WHERE
    Total_assets_to_GNP_price > 1;
    
#10. CALCULATE THE AVERAGE AND MAXIMUM CASHFLOW TO SALES RATIO FOR COMPANIES THAT HAVE A 
#    POSITIVE OPERATING PROFIT RATE
SELECT 
    AVG(Cash_Flow_to_Sales) AS avg_cash_flow_to_sales,
    MAX(Cash_Flow_to_Sales) AS max_cash_flow_to_sales
FROM
    bankrupcy_dataset
WHERE
    operating_profit_rate > 0;
    
#11. CALCULATE THE AVERAGE NET INCOME TO TOTAL ASSETS RATIO AMONG COMPANIES WITH A TAX RATE GREATER THAN 30%
SELECT 
    AVG(net_income_to_Total_Assets) AS avg_net_income_to_total_assets
FROM
    bankrupcy_dataset
WHERE
    Tax_rate > 0.30;
    
#12. NUMBER OF COMPANIES THAT HAVE EXPERIENCE NEGATIVE GROWTH RATE IN OPERATING PROFIT
SELECT 
    COUNT(*) as companies_with_negative_OPR
FROM
    bankrupcy_dataset
WHERE
    Operating_Profit_Rate < 0;
    
#13. NUMBER OF COMPANIES HAVING TOTAL ASSET TURNOVER GREATER THAN 0.3 AND BORROWING DEPENDENCY GREATER THAN 0.5
SELECT 
    COUNT(*)
FROM
    bankrupcy_dataset
WHERE
    Total_Asset_Turnover > 0.3
        AND borrowing_dependency > 0.5;

#14. CREATE A VIEW NAMED "HighGrowthCompanies" THAT INCLUDES COMPANY ID,REALIZED SALES GROSS PROFIT GROWTH RATE,
#    TOTAL ASSET GROWTH RATE FOR COMPANIES WITH A TOTAL ASSET GROWTH RATE GREATER THAN 0.5 AND REALIZED SALES GROSS 
#    PROFIT GROWTH RATE GREATER THAN 0.03
CREATE VIEW HighGrowthCompanies AS
    SELECT 
        Company_id,
        Realized_Sales_Gross_Profit_Growth_Rate,
        Total_Asset_Growth_Rate, Bankrupt
    FROM
        bankrupcy_dataset
    WHERE
        Realized_Sales_Gross_Profit_Growth_Rate > 0.03
            AND Total_Asset_Growth_Rate > 0.5;

select * from HighGrowthCompanies;

#15.HIGH GROWTH COMPANIES THAT HAVE GONE BANKRUPT
SELECT 
    company_id
FROM
    HighGrowthCompanies
WHERE
    bankrupt = 1;


    
    

